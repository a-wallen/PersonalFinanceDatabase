USE jw_group05_db;

CREATE TABLE IF NOT EXISTS BROKERAGE (
PAYOR_ID VARCHAR(10) PRIMARY KEY,
    NAME     VARCHAR(20),
    ADDRESS  VARCHAR(30),
    COMMISSION DECIMAL(3,2),
    BROKERAGE_TYPE VARCHAR(3),
    INDEPENDENT_CAPTIVE VARCHAR(1)
);

CREATE TABLE IF NOT EXISTS ACCOUNT (
    ACCOUNT_NUM  VARCHAR(10) PRIMARY KEY,
    PAYOR_ID     VARCHAR(10),
    INVESTMENT_ID  VARCHAR(5),
    TRANSACTION_ID VARCHAR(5),
    BALANCE DECIMAL(10,2),
    TRUSTED_CONTACT VARCHAR(30),
    ACCOUNT_TYPE VARCHAR(3),
    FOREIGN KEY(PAYOR_ID) REFERENCES BROKERAGE(PAYOR_ID)
);

CREATE TABLE IF NOT EXISTS INDIVIDUAL (
    ACCOUNT_NUM VARCHAR(10) PRIMARY KEY,
    TAXABLE_NOW VARCHAR(1),
    PROFIT_TAX DECIMAL(3,2)
);

CREATE TABLE IF NOT TABLE EXISTS JOINT (
    ACCOUNT_NUM VARCHAR(10) PRIMARY KEY,
    JOINT_OWNER_CREDENTIALS VARCHAR(20)
);

CREATE TABLE IF NOT EXISTS TRUST (
    ACCOUNT_NUM VARCHAR(10) PRIMARY KEY,
    TAX_UPON_WITHDRAWL DECIMAL(3,2)
);

CREATE TABLE IF NOT EXISTS IRA (
    ACCOUNT_NUM VARCHAR(10) PRIMARY KEY,
    DEPOSIT_CAP INTEGER UNSIGNED,
    TAX_UPON_WITHDRAWL DECIMAL(3,2)
);

CREATE TABLE IF NOT EXISTS 401K (
    ACCOUNT_NUM	VARCHAR(10)	PRIMARY KEY,
    DEPOSIT_CAP UNSIGNED INT 	NOT NULL  ,
    FEES   		  DECIMAL(3,2) 	NOT NULL  ,
    INCOME		  FLOAT(10,2),
    SPONSOR		  VARCHAR(20),
);

CREATE TABLE IF NOT EXISTS TRANSACTION(
    TRANSACTION_ID	VARCHAR(20)	PRIMARY KEY,
    ACCOUNT_NUM		  VARCHAR(1)	NOT NULL,
    ACCOUNT_BALANCE	UNSIGNED INT,
    TRANSACT_DATE		DATE    		NOT NULL,
    TRANSACT_TYPE		VARCHAR(3),
    FOREIGN KEY (ACCOUNT_NUM) REFERENCES ACCOUNT(ACCOUNT_NUM)
);

CREATE TABLE IF NOT EXISTS ACCT_HISTORY(
    TRANSACTION_ID	VARCHAR(20) PRIMARY KEY,
    ACCOUNT_NUM		  VARCHAR(1)  NOT NULL,
    DATE				    DATE        NOT NULL,
    BALANCE			    FLOAT(10,2),
    FOREIGN KEY(ACCOUNT_NUM) REFERENCES ACCOUNT(ACCOUNT_NUM)
);

CREATE TABLE IF NOT EXISTS PURCHASE(
  TRANSACTION_ID	VARCHAR(20) 	PRIMARY KEY,
  INVESTMENT_ID		VARCHAR(20)	NOT NULL,
  ACCOUNT_NUM		VARCHAR(1)	NOT NULL,
);

CREATE TABLE IF NOT EXISTS WITHDRAWAL(
    TRANSACTION_ID	VARCHAR(20) PRIMARY KEY,
    AMOUNT_WITHDRAW	UNSIGNED INT,
    ACCOUNT_NUM		  VARCHAR(1) NOT NULL,
    FOREIGN KEY(ACCOUNT_NUM) REFERENCES ACCOUNT (ACCOUNT_NUM)
);

CREATE TABLE IF NOT EXISTS DIVIDEND(
    TRANSACTION_ID	VARCHAR(20) 	PRIMARY KEY,
    INVESTMENT_ID		VARCHAR(20)	  NOT NULL,
    ACCOUNT_NUM		  VARCHAR(1)	  NOT NULL,
    AMOUNT			    UNSIGNED INT,
    FOREIGN KEY (INVESTMENT_ID) REFERENCES INVESTMENT(INVESTMENT_ID)
);

CREATE TABLE IF NOT EXISTS SALE(
    TRANSACTION_ID VARCHAR(20) NOT NULL,
    INVESTMENT_ID VARCHAR(20) NOT NULL,
    AMOUNT INT NOT NULL,
    ACCOUNT_NUM VARCHAR(1) NOT NULL,
    PRIMARY KEY(TRANSACTION_ID),
    FOREIGN KEY(INVESTMENT_ID)
        REFERENCES INVESTMENT(INVESTMENT_ID)
        ON UPDATE RESTRICT ON DELETE RESTRICT,
    FOREIGN KEY(ACCOUNT_NUM)
        REFERENCES ACCOUNT(ACCOUNT_NUM)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS DEPOSIT(
    TRANSACTION_ID VARCHAR(20) NOT NULL,
    AMOUNT_DEPOSIT INT NOT NULL,
    ACCOUNT_NUM VARCHAR(1) NOT NULL,
    PRIMARY KEY(TRANSACTION_ID),
    FOREIGN KEY(TRANSACTION_ID)
        REFERENCES TRANSACTION(TRANSACTION_ID)
        ON UPDATE RESTRICT ON DELETE RESTRICT,
    FOREIGN KEY(ACCOUNT_NUM)
        REFERENCES ACCOUNT(ACCOUNT_NUM)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS INVESTMENT(
    INVESTMENT_ID VARCHAR(20),
    TRANSACTION_ID VARCHAR (20),
    ACCOUNT_NUM VARCHAR(1),
    PRIMARY KEY (INVESTMENT_ID),
    FOREIGN KEY (TRANSACTION_ID)
        REFERENCES TRANSACTION(TRANSACTION_ID)
        ON UPDATE RESTRICT ON DELETE RESTRICT,
    FOREIGN KEY (ACCOUNT_NUM)
        REFERENCES ACCOUNT(ACCOUNT_NUM)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS INVEST_HISTORY(
    INVESTMENT_ID VARCHAR(20) NOT NULL,
    INVEST_DATE TIMESTAMP,
    PRICE INT,
    DIVIDEND FLOAT(3, 1),
    TICKER CHAR(3),
    UNITS INT,
    PRIMARY KEY(INVESTMENT_ID),
    FOREIGN KEY(INVESTMENT_ID)
        REFERENCES INVESTMENT(INVESTMENT_ID)
        ON UPDATE RESTRICT ON DELETE RESTRICT
);

CREATE TABLE IF NOT EXISTS INVEST_SECTORS(
    INVESTMENT_ID VARCHAR(20) NOT NULL,
    SECTOR_ID VARCHAR(1) NOT NULL,
    PRIMARY KEY(INVESTMENT_ID, SECTOR_ID),
    FOREIGN KEY (INVESTMENT_ID)
        REFERENCES INVESTMENT(INVESTMENT.INVESTMENT_ID)
        ON UPDATE CASCADE ON DELETE RESTRICT,
    FOREIGN KEY (SECTOR_ID)
        REFERENCES SECTOR(SECTOR.SECTOR_ID)
        ON UPDATE CASCADE ON DELETE RESTRICT,
);

CREATE TABLE IF NOT EXISTS SECTOR (
    # ATTRIBUTE, TYPE, IF REQUIRED NOT NULL, AUTOINCREMENT IF PK
    SECTOR_ID VARCHAR(1) NOT NULL,
    SECTOR_NAME VARCHAR(30) NOT NULL,
    TAXABLE FLOAT(1) NOT NULL,
    PRIMARY KEY (SECTOR_ID)
);
